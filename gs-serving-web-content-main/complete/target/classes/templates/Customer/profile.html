<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <title>H·ªì S∆° Kh√°ch H√†ng</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        function openModal(id) {
            document.getElementById(id).classList.remove('hidden');
        }
        function closeModal(id) {
            document.getElementById(id).classList.add('hidden');
        }
    </script>
</head>
<body class="bg-yellow-50 min-h-screen font-sans">
<div class="max-w-6xl mx-auto py-10 px-4">
    <div class="bg-white shadow-lg rounded-xl p-8">
        <h1 class="text-3xl font-bold text-yellow-800 text-center mb-6">üë§ H·ªì S∆° Kh√°ch H√†ng</h1>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mb-8">
            <div>
                <label class="text-gray-600 font-medium">üìß Email:</label>
                <p class="bg-gray-100 p-2 rounded" th:text="${user.email}">example@gmail.com</p>
            </div>
            <div>
                <label class="text-gray-600 font-medium">üë§ H·ªç t√™n:</label>
                <p class="bg-gray-100 p-2 rounded" th:text="${user.hoTen}">Nguy·ªÖn VƒÉn A</p>
            </div>
            <div>
                <label class="text-gray-600 font-medium">üîê M·∫≠t kh·∫©u:</label>
                <input type="password" class="bg-gray-100 p-2 rounded w-full" th:value="${user.password}" readonly />
            </div>
        </div>

        <div class="flex gap-4 justify-center">
            <button onclick="openModal('modalPassword')" class="bg-yellow-600 hover:bg-yellow-700 text-white px-5 py-2 rounded-lg shadow">ƒê·ªïi m·∫≠t kh·∫©u</button>
            <button onclick="openModal('modalEmail')" class="bg-yellow-600 hover:bg-yellow-700 text-white px-5 py-2 rounded-lg shadow">ƒê·ªïi Email</button>
        </div>

        <hr class="my-10 border-yellow-300">

        <h2 class="text-2xl font-bold text-yellow-800 mb-6">üßæ L·ªãch s·ª≠ h√≥a ƒë∆°n</h2>

        <div th:each="hd : ${dsHoaDon}" class="bg-white border-l-4 border-yellow-400 p-4 rounded shadow mb-6">
            <p><strong>M√£ h√≥a ƒë∆°n:</strong> <span th:text="${hd.idHoaDon}">1</span></p>
            <p><strong>Ng√†y l·∫≠p:</strong> <span th:text="${hd.ngayHD}">2025-06-29 02:52:57</span></p>
            <p><strong>Tr·∫°ng th√°i:</strong> <span th:text="${hd.trangthai}">Th√†nh c√¥ng</span></p>
            <p><strong>T·ªïng ti·ªÅn:</strong>
                <span th:text="${hd.tongtien} + ' ‚Ç´'">100000 ‚Ç´</span>
            </p>
            <button class="mt-2 text-blue-600 underline"
                    th:onclick="'openModal(\'cthdModal-' + ${hd.idHoaDon} + '\')'">
                Xem chi ti·∫øt m√≥n ƒÉn
            </button>
        </div>

        <div class="text-center mt-6">
            <a href="/CustomerHome" class="text-yellow-700 font-semibold underline">‚Üê Quay v·ªÅ trang ch·ªß</a>
        </div>
    </div>
</div>

<!-- Modal: ƒê·ªïi m·∫≠t kh·∫©u -->
<div id="modalPassword" class="hidden fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50">
    <div class="bg-white p-6 rounded-xl shadow-xl w-full max-w-md relative">
        <h2 class="text-xl font-bold mb-4 text-yellow-800">ƒê·ªïi m·∫≠t kh·∫©u</h2>
        <form method="post" th:action="@{/updatePassword}">
            <input type="password" name="newPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi" required class="w-full p-3 border rounded mb-4">
            <div class="flex justify-between">
                <button type="submit" class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded">C·∫≠p nh·∫≠t</button>
                <button type="button" onclick="closeModal('modalPassword')" class="text-gray-600 underline">H·ªßy</button>
            </div>
        </form>
    </div>
</div>

<!-- Modal: ƒê·ªïi email -->
<div id="modalEmail" class="hidden fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50">
    <div class="bg-white p-6 rounded-xl shadow-xl w-full max-w-md relative">
        <h2 class="text-xl font-bold mb-4 text-yellow-800">ƒê·ªïi Email</h2>
        <form method="post" th:action="@{/updateEmail}">
            <input type="email" name="newEmail" placeholder="Nh·∫≠p email m·ªõi" required class="w-full p-3 border rounded mb-4">
            <div class="flex justify-between">
                <button type="submit" class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded">C·∫≠p nh·∫≠t</button>
                <button type="button" onclick="closeModal('modalEmail')" class="text-gray-600 underline">H·ªßy</button>
            </div>
        </form>
    </div>
</div>

<!-- Modal chi ti·∫øt h√≥a ƒë∆°n -->
<div th:each="hd : ${dsHoaDon}" th:id="'cthdModal-' + ${hd.idHoaDon}"
     class="hidden fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-xl p-6 w-full max-w-2xl">
        <h3 class="text-lg font-bold text-yellow-800 mb-4">
            Chi ti·∫øt m√≥n ƒÉn - H√≥a ƒë∆°n <span th:text="${hd.idHoaDon}">1</span>
        </h3>
        <table class="w-full border text-center">
            <thead class="bg-yellow-100">
                <tr>
                    <th class="p-2 border">T√™n m√≥n</th>
                    <th class="p-2 border">S·ªë l∆∞·ª£ng</th>
                    <th class="p-2 border">ƒê∆°n gi√°</th>
                    <th class="p-2 border">Th√†nh ti·ªÅn</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="item : ${hd.dsMonAn}">
                    <td class="p-2 border" th:text="${item.tenMonAn}">C∆°m g√†</td>
                    <td class="p-2 border" th:text="${item.soLuong}">2</td>
                    <td class="p-2 border" th:text="${item.donGia} + ' ‚Ç´'">50000 ‚Ç´</td>
                    <td class="p-2 border" th:text="${item.thanhTien} + ' ‚Ç´'">100000 ‚Ç´</td>
                </tr>
            </tbody>
        </table>
        <div class="text-right mt-4">
            <button class="text-gray-600 underline"
                    th:onclick="'closeModal(\'cthdModal-' + ${hd.idHoaDon} + '\')'">ƒê√≥ng</button>
        </div>
    </div>
</div>
</body>
</html>

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Qu·∫£n l√Ω B√†n ƒÇn</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background-color: #f4f6f8;
        }

        h2 {
            text-align: center;
            margin: 30px 0 10px;
            font-size: 26px;
            color: #2c3e50;
        }

        .center {
            text-align: center;
            margin-top: 20px;
        }

        input {
            padding: 10px 14px;
            margin: 6px;
            border: 1px solid #ccc;
            border-radius: 8px;
            outline: none;
            width: 200px;
            font-size: 14px;
            transition: 0.3s ease;
        }

        input:focus {
            border-color: #3498db;
            box-shadow: 0 0 6px rgba(52, 152, 219, 0.3);
        }

        button {
            padding: 10px 16px;
            margin: 4px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s ease;
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        button:hover:not(:disabled) {
            opacity: 0.9;
        }

        /* Style n√∫t theo lo·∫°i */
        .btn-add {
            background-color: #2ecc71;
            color: white;
        }

        .btn-add:hover {
            background-color: #27ae60;
        }

        .btn-edit {
            background-color: #f1c40f;
            color: white;
        }

        .btn-edit:hover {
            background-color: #f39c12;
        }

        .btn-delete {
            background-color: #e74c3c;
            color: white;
        }

        .btn-delete:hover {
            background-color: #c0392b;
        }

        table {
            width: 90%;
            margin: 30px auto;
            border-collapse: separate;
            border-spacing: 0;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0,0,0,0.05);
            background-color: #ffffff;
        }

        th, td {
            padding: 14px;
            text-align: center;
            border-bottom: 1px solid #f0f0f0;
        }

        th {
            background-color: #ecf0f1;
            font-weight: bold;
            color: #34495e;
        }

        tr:last-child td {
            border-bottom: none;
        }
    </style>
</head>
<body>

<h2>Qu·∫£n l√Ω B√†n ƒÇn</h2>

<div class="center">
    <input type="text" id="searchInput" placeholder="üîç T√¨m t√™n b√†n..." oninput="timBan()">
</div>

<div class="center">
    <input type="text" id="tenBanMoi" placeholder="T√™n b√†n m·ªõi">
    <input type="text" id="trangThaiMoi" placeholder="Tr·∫°ng th√°i (Tr·ªëng/ƒê√£ ƒë·∫∑t)">
    <button class="btn-add" onclick="themBan()">‚ûï Th√™m b√†n</button>
</div>

<table>
    <thead>
        <tr>
            <th>M√£ B√†n</th>
            <th>T√™n B√†n</th>
            <th>Tr·∫°ng Th√°i</th>
            <th>H√†nh ƒë·ªông</th>
        </tr>
    </thead>
    <tbody id="banan-table-body">
        <!-- D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c load t·ª´ API -->
    </tbody>
</table>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        loadBanAn();
    });

    function loadBanAn() {
        fetch("/ban/api")
            .then(res => res.json())
            .then(data => {
                const tableBody = document.getElementById("banan-table-body");
                tableBody.innerHTML = "";

                data.forEach(ban => {
                    const row = document.createElement("tr");
                    row.innerHTML = `
                        <td>${ban.maBan}</td>
                        <td>${ban.tenBan}</td>
                        <td>${ban.trangThai}</td>
                        <td>
                            <button class="btn-edit" onclick="suaBan(${ban.maBan}, '${ban.tenBan}', '${ban.trangThai}')">‚úèÔ∏è S·ª≠a</button>
                            <button class="btn-delete" onclick="xoaBan(${ban.maBan})">üóëÔ∏è Xo√°</button>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
            })
            .catch(error => alert("L·ªói t·∫£i danh s√°ch: " + error.message));
    }

    function themBan() {
        const tenBan = document.getElementById("tenBanMoi").value;
        const trangThai = document.getElementById("trangThaiMoi").value;

        if (!tenBan || !trangThai) {
            alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!");
            return;
        }

        fetch("/ban/api/them", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ tenBan, trangThai })
        })
        .then(res => res.text())
        .then(msg => {
            alert(msg);
            document.getElementById("tenBanMoi").value = "";
            document.getElementById("trangThaiMoi").value = "";
            loadBanAn();
        });
    }

    function suaBan(maBan, oldTenBan, oldTrangThai) {
        const tenBan = prompt("S·ª≠a t√™n b√†n:", oldTenBan);
        const trangThai = prompt("S·ª≠a tr·∫°ng th√°i:", oldTrangThai);

        if (tenBan && trangThai) {
            fetch("/ban/api/sua", {
                method: "PUT",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ maBan, tenBan, trangThai })
            })
            .then(res => res.text())
            .then(msg => {
                alert(msg);
                loadBanAn();
            });
        }
    }

    function xoaBan(maBan) {
        if (confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën xo√° b√†n n√†y?")) {
            fetch(`/ban/api/xoa/${maBan}`, { method: "DELETE" })
                .then(res => res.text())
                .then(msg => {
                    alert(msg);
                    loadBanAn();
                });
        }
    }

    function timBan() {
        const keyword = document.getElementById("searchInput").value.toLowerCase();
        const rows = document.querySelectorAll("#banan-table-body tr");
        rows.forEach(row => {
            const tenBan = row.children[1].innerText.toLowerCase();
            row.style.display = tenBan.includes(keyword) ? "" : "none";
        });
    }
</script>

</body>
</html>
